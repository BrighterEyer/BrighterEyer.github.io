<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>BrighterEyer</title>
  
  <subtitle>用心看清世界，不要驻足停留</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://brightereyer.xyz/"/>
  <updated>2019-04-24T11:00:16.000Z</updated>
  <id>http://brightereyer.xyz/</id>
  
  <author>
    <name>brightereyer</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>[wxs] 时间格式化</title>
    <link href="http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103616000.html/"/>
    <id>http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103616000.html/</id>
    <published>2019-04-24T11:00:16.000Z</published>
    <updated>2019-04-24T11:00:16.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.jianshu.com/p/4379da8668fb" target="_blank">小程序wxs中的时间格式化以及格式化时间和date时间互转</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function parse(fmt) &#123;</span><br><span class="line">  fmt1 = fmt.substring(0, 19);</span><br><span class="line">  var reg = getRegExp(&quot;-&quot;, &quot;g&quot;);</span><br><span class="line">  fmt2 = fmt1.replace(reg, &apos;/&apos;);</span><br><span class="line">  var timestamp = getDate(fmt2).getTime();</span><br><span class="line">  return timestamp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function getDateByDateTimeFmt(dateTimeFmt) &#123;</span><br><span class="line">  return dateFormat(parse(dateTimeFmt), &apos;yyyy-MM-dd&apos;);</span><br><span class="line">&#125;</span><br><span class="line">module.exports = &#123;</span><br><span class="line">  getDateByDateTimeFmt: getDateByDateTimeFmt</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p><a href="https://wanglinyong.github.io/wanglinyong.github.io/2018/05/11/微信小程序日期格式化/" target="_blank">微信小程序日期格式化</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">const formatTime = date =&gt; &#123;</span><br><span class="line">  var date = new Date(date);  </span><br><span class="line">  const year = date.getFullYear()</span><br><span class="line">  const month = date.getMonth() + 1</span><br><span class="line">  const day = date.getDate()</span><br><span class="line">  const hour = date.getHours()</span><br><span class="line">  const minute = date.getMinutes()</span><br><span class="line">  const second = date.getSeconds()</span><br><span class="line"></span><br><span class="line">  return [year, month, day].map(formatNumber).join(&apos;-&apos;) + &apos; &apos; + [hour, minute, second].map(formatNumber).join(&apos;:&apos;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">  formatTime: formatTime</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://www.jianshu.com/p/4379da8668fb&quot; target=&quot;_blank&quot;&gt;小程序wxs中的时间格式化以及格式化时间和date时间互转&lt;/a&gt;&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;ta
      
    
    </summary>
    
    
      <category term="wxs" scheme="http://brightereyer.xyz/tags/wxs/"/>
    
  </entry>
  
  <entry>
    <title>[小程序] 自定义顶部导航栏</title>
    <link href="http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103615000.html/"/>
    <id>http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103615000.html/</id>
    <published>2019-04-24T11:00:15.000Z</published>
    <updated>2019-04-24T11:00:15.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.jianshu.com/p/5877a3dc0b1e" target="_blank">微信小程序电商实战-自定义顶部导航栏</a><br><a href="https://github.com/FaureWu/weapp-clover" target="_blank">github|weapp-clover</a><br><a href="https://www.cnblogs.com/juewuzhe/p/9884124.html" target="_blank">微信小程序（18）– 自定义头部导航栏</a><br><a href="https://www.jianshu.com/p/5753a0e1754f" target="_blank">微信小程序：自定义导航栏</a><br><a href="https://segmentfault.com/q/1010000016234677" target="_blank">小程序自定义顶部导航栏的样式问题::after</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://www.jianshu.com/p/5877a3dc0b1e&quot; target=&quot;_blank&quot;&gt;微信小程序电商实战-自定义顶部导航栏&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://github.com/FaureWu/weapp-clov
      
    
    </summary>
    
    
      <category term="小程序" scheme="http://brightereyer.xyz/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>[小程序] 自定义底部tab</title>
    <link href="http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103614000.html/"/>
    <id>http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103614000.html/</id>
    <published>2019-04-24T11:00:14.000Z</published>
    <updated>2019-04-24T11:00:14.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.jianshu.com/p/8f1894e82dc6" target="_blank">weui小程序自定义底部tab</a><br><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/ability/custom-tabbar.html" target="_blank">自定义tabBar</a><br>templates/tabbar.wxml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template name=&quot;tabBar&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;view class=&quot;tab-bar&quot; style=&quot;color: &#123;&#123;tabBar.color&#125;&#125;; background: &#123;&#123;tarBar.backgroundColor&#125;&#125;; &#123;&#123;tabBar.position==&apos;top&apos;? &apos;top: 0&apos; : &apos;bottom: 0&apos;&#125;&#125;; &#123;&#123;tabBar.borderStyle? (tabBar.position==&apos;top&apos;? &apos;border-bottom: solid 1px &apos;+tabBar.borderStyle + &apos;;&apos; : &apos;border-top: solid 1px &apos;+tabBar.borderStyle + &apos;;&apos;) : &apos;&apos;&#125;&#125;&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;block wx:for=&quot;&#123;&#123;tabBar.list&#125;&#125;&quot; wx:key=&quot;pagePath&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;navigator url=&quot;&#123;&#123;item.pagePath&#125;&#125;&quot; open-type=&quot;redirect&quot; class=&quot;&#123;&#123;item.styleClass&#125;&#125;&quot; style=&quot;&#123;&#123;item.active? &apos;color: &apos;+(item.selectedColor? item.selectedColor : tabBar.selectedColor) : &apos;&apos;&#125;&#125;&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;image src=&quot;&#123;&#123;item.selectedIconPath&#125;&#125;&quot; wx:if=&quot;&#123;&#123;item.active&#125;&#125;&quot; class=&quot;bottom-tabbar-icon&quot;&gt;&lt;/image&gt;</span><br><span class="line">        &lt;image src=&quot;&#123;&#123;item.iconPath&#125;&#125;&quot;  wx:if=&quot;&#123;&#123;!item.active&#125;&#125;&quot; class=&quot;bottom-tabbar-icon&quot;&gt;&lt;/image&gt;</span><br><span class="line">        &lt;text&gt;&#123;&#123;item.text&#125;&#125;&lt;/text&gt;</span><br><span class="line"></span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/block&gt;</span><br><span class="line"></span><br><span class="line">    &lt;view class=&quot;clear&quot;&gt;&lt;/view&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure></p><p>app.wxss<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">.bottom-tabbar-icon &#123;</span><br><span class="line">  width: 23px;</span><br><span class="line">  height: 23px;</span><br><span class="line">  display: block;</span><br><span class="line">  margin: auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.clear &#123;</span><br><span class="line">  clear: both;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.tab-bar &#123;</span><br><span class="line">  background-color:rgb(243, 243, 243);</span><br><span class="line">  opacity: .8;</span><br><span class="line">  position: fixed;</span><br><span class="line">  width: 100%;</span><br><span class="line">  /* padding: 0px 2%; */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">App(&#123;</span><br><span class="line"> editTabBar: function () &#123;</span><br><span class="line">    var _curPageArr = getCurrentPages();</span><br><span class="line">    var _curPage = _curPageArr[_curPageArr.length - 1];</span><br><span class="line">    var _pagePath = _curPage.__route__;</span><br><span class="line">    if (_pagePath.indexOf(&apos;/&apos;) != 0) &#123;</span><br><span class="line">      _pagePath = &apos;/&apos; + _pagePath;</span><br><span class="line">    &#125;</span><br><span class="line">    var tabBar = this.globalData.tabBar;</span><br><span class="line">    for (var i = 0; i &lt; tabBar.list.length; i++) &#123;</span><br><span class="line">      tabBar.list[i].active = false;</span><br><span class="line">      if (tabBar.list[i].pagePath == _pagePath) &#123;</span><br><span class="line">        tabBar.list[i].active = true;//根据页面地址设置当前页面状态</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    _curPage.setData(&#123;</span><br><span class="line">      tabBar: tabBar</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line"> </span><br><span class="line">  globalData: &#123;</span><br><span class="line"></span><br><span class="line">    tabBar: &#123;</span><br><span class="line">      color: &quot;#a9b7b7&quot;,</span><br><span class="line">      selectedColor: &quot;#ff8124&quot;,</span><br><span class="line">      borderStyle: &quot;white&quot;,</span><br><span class="line">      list: [</span><br><span class="line">        &#123;</span><br><span class="line">          selectedIconPath: &quot;/images/logo.png&quot;,</span><br><span class="line">          iconPath: &quot;/images/logo.png&quot;,</span><br><span class="line">          pagePath: &quot;/pages/index/index&quot;,</span><br><span class="line">          text: &quot;首页&quot;,</span><br><span class="line">          styleClass: &quot;menu-item&quot;,</span><br><span class="line">          selected: false,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          selectedIconPath: &quot;/images/logo.png&quot;,</span><br><span class="line">          iconPath: &quot;/images/logo.png&quot;,</span><br><span class="line">          pagePath: &quot;/pages/mine/index&quot;,</span><br><span class="line">          text: &quot;我的&quot;,</span><br><span class="line">          styleClass: &quot;menu-item&quot;,</span><br><span class="line">          selected: false</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      position: &quot;bottom&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>index.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const app = getApp()</span><br><span class="line"> </span><br><span class="line">Page(&#123;</span><br><span class="line">  onLoad: function (options) &#123;</span><br><span class="line">    app.editTabBar();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p><p>index.wxml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;import src=&quot;../../templates/tabbar.wxml&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;view class=&quot;container&quot;&gt;</span><br><span class="line">  &lt;template is=&quot;tabBar&quot; data=&quot;&#123;&#123;tabBar&#125;&#125;&quot; /&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://www.jianshu.com/p/8f1894e82dc6&quot; target=&quot;_blank&quot;&gt;weui小程序自定义底部tab&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://developers.weixin.qq.com/minipro
      
    
    </summary>
    
    
      <category term="小程序" scheme="http://brightereyer.xyz/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>[小程序] 图片打包优化</title>
    <link href="http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103613000.html/"/>
    <id>http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103613000.html/</id>
    <published>2019-04-24T11:00:13.000Z</published>
    <updated>2019-04-24T11:00:13.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.cnblogs.com/web1/p/8926807.html" target="_blank">小程序打包代码包过大的解决方法</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">解决方案就是优化图片了，优化的主要过程和目的是减小图片的大小。</span><br><span class="line"></span><br><span class="line">　　1、去掉小图标的切图图片，改用iconfont字体图标</span><br><span class="line"></span><br><span class="line">　　2、尽量避免使用png格式的图片，使用jpg格式</span><br><span class="line"></span><br><span class="line">　　3、设计稿上图片是x2倍大小，切图导出时使用正常大小，不要使用x2大小的图片</span><br><span class="line"></span><br><span class="line">　　4、视情况压缩图片质量，在导出选项内有</span><br><span class="line"></span><br><span class="line">　　如果不是自己切图的，可以提醒ui切图注意以上几点</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/web1/p/8926807.html&quot; target=&quot;_blank&quot;&gt;小程序打包代码包过大的解决方法&lt;/a&gt;&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;
      
    
    </summary>
    
    
      <category term="小程序" scheme="http://brightereyer.xyz/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>[小程序] 实现navbar导航栏</title>
    <link href="http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103612000.html/"/>
    <id>http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103612000.html/</id>
    <published>2019-04-24T11:00:12.000Z</published>
    <updated>2019-04-24T11:00:12.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.cnblogs.com/llcdxh/p/9390375.html" target="_blank">实现navbar导航栏</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/llcdxh/p/9390375.html&quot; target=&quot;_blank&quot;&gt;实现navbar导航栏&lt;/a&gt;&lt;/p&gt;

      
    
    </summary>
    
    
      <category term="小程序" scheme="http://brightereyer.xyz/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>[小程序] 上传多张图片</title>
    <link href="http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103611000.html/"/>
    <id>http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103611000.html/</id>
    <published>2019-04-24T11:00:11.000Z</published>
    <updated>2019-04-24T11:00:11.000Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/LeoMelody/jianshu/blob/master/smallDemo/upload/UploadController.java</span><br><span class="line">https://github.com/LeoMelody/jianshu/blob/master/smallDemo/upload/upload.js</span><br></pre></td></tr></table></figure><p><a href="https://segmentfault.com/a/1190000017026145" target="_blank">多文件上传（递归）</a></p><p>UploadFilesUtil.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">export function uploadFiles(url, filePathArr) &#123;</span><br><span class="line">  return uploadFilesSync(url, filePathArr, 0, &#123;</span><br><span class="line">    success: [],</span><br><span class="line">    fail: []</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function uploadFilesSync(url, filePathArr, index, result) &#123;</span><br><span class="line">  return upload(url, filePathArr[index++], &#123;&#125;)</span><br><span class="line">    .then(res =&gt; &#123;</span><br><span class="line">      result.success.push(&#123;</span><br><span class="line">        index: index,</span><br><span class="line">        res: res</span><br><span class="line">      &#125;);</span><br><span class="line">      if (index === filePathArr.length) &#123;</span><br><span class="line">        return result;</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        return uploadFilesSync(url, filePathArr, index, result);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(err =&gt; &#123;</span><br><span class="line">      result.fail.push(&#123;</span><br><span class="line">        index: index,</span><br><span class="line">        res: err</span><br><span class="line">      &#125;);</span><br><span class="line">      if (index === filePathArr.length) &#123;</span><br><span class="line">        return result;</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        return uploadFilesSync(url, filePathArr, index, result);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export function upload(url, filePath, formData = &#123;&#125;) &#123;</span><br><span class="line">  let header = &#123;</span><br><span class="line">    &quot;Content-Type&quot;: &quot;multipart/form-data&quot;</span><br><span class="line">  &#125;;</span><br><span class="line">  return new Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">    wx.uploadFile(&#123;</span><br><span class="line">      url: config.server + url,</span><br><span class="line">      header: header,</span><br><span class="line">      filePath: filePath,</span><br><span class="line">      name: &quot;file&quot;,</span><br><span class="line">      formData: formData,</span><br><span class="line">      success(res) &#123;</span><br><span class="line">        resolve(res.data);</span><br><span class="line">      &#125;,</span><br><span class="line">      fail: function(error) &#123;</span><br><span class="line">        reject(error);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><a href="https://www.jianshu.com/p/296680d6b173" target="_blank">上传多张图片</a><br><a href="https://github.com/dt8888/moreImgaes" target="_blank">github|上传多张图片</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;
      
    
    </summary>
    
    
      <category term="小程序" scheme="http://brightereyer.xyz/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>[小程序] 日期、星期选择功能</title>
    <link href="http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103610000.html/"/>
    <id>http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103610000.html/</id>
    <published>2019-04-24T11:00:10.000Z</published>
    <updated>2019-04-24T11:00:10.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://blog.csdn.net/m0_37852904/article/details/80701664" target="_blank">日期、星期选择功能</a></p><p>js内（如utils.js）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">// 获取d当前时间多少天后的日期和对应星期</span><br><span class="line">function getDates(days) &#123;</span><br><span class="line">  var todate = getCurrentMonthFirst()</span><br><span class="line">  var dateArry = [];</span><br><span class="line">  for (var i = 0; i &lt; days; i++) &#123;</span><br><span class="line">    var dateObj = dateLater(todate, i);</span><br><span class="line">    dateArry.push(dateObj)</span><br><span class="line">  &#125;</span><br><span class="line">  return dateArry;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 传入时间后几天</span><br><span class="line">  * param：传入时间：dates: &quot;2018-04-02&quot;, later:往后多少天</span><br><span class="line"> */</span><br><span class="line">function dateLater(dates, later) &#123;</span><br><span class="line">  let dateObj = &#123;&#125;;</span><br><span class="line">  let show_day = new Array(&apos;周日&apos;, &apos;周一&apos;, &apos;周二&apos;, &apos;周三&apos;, &apos;周四&apos;, &apos;周五&apos;, &apos;周六&apos;);</span><br><span class="line">  let date = new Date(dates);</span><br><span class="line">  date.setDate(date.getDate() + later);</span><br><span class="line">  let day = date.getDay();</span><br><span class="line">  dateObj.year = date.getFullYear();</span><br><span class="line">  dateObj.month = ((date.getMonth() + 1) &lt; 10 ? (&quot;0&quot; + (date.getMonth() + 1)) : date.getMonth());</span><br><span class="line">  dateObj.day = (date.getDate() &lt; 10 ? (&quot;0&quot; + date.getDate()) : date.getDate());</span><br><span class="line">  dateObj.week = show_day[day];</span><br><span class="line">  return dateObj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 获取当前时间</span><br><span class="line">function getCurrentMonthFirst() &#123;</span><br><span class="line">  var date = new Date();</span><br><span class="line">  var todate = date.getFullYear() + &quot;-&quot; + ((date.getMonth() + 1) &lt; 10 ? (&quot;0&quot; + (date.getMonth() + 1)) : date.getMonth()) + &quot;-&quot; + (date.getDate() &lt; 10 ? (&quot;0&quot; + date.getDate()) : date.getDate());</span><br><span class="line">  return todate;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//获得某月的最后一天  </span><br><span class="line">function getLastDay(year, month) &#123;</span><br><span class="line">  var new_year = year;    //取当前的年份          </span><br><span class="line">  var new_month = month++;//取下一个月的第一天，方便计算（最后一天不固定）          </span><br><span class="line">  if (month &gt; 12) &#123;</span><br><span class="line">    new_month -= 12;        //月份减          </span><br><span class="line">    new_year++;            //年份增          </span><br><span class="line">  &#125;</span><br><span class="line">  var new_date = new Date(new_year, new_month, 1);                //取当年当月中的第一天          </span><br><span class="line">  return (new Date(new_date.getTime() - 1000 * 60 * 60 * 24)).getDate();//获取当月最后一天日期          </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">  getDates: getDates,</span><br><span class="line">  dateLater: dateLater,</span><br><span class="line">  getLastDay: getLastDay</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>页面js中引入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line">var week = require(&apos;../../utils/util.js&apos;);</span><br><span class="line"></span><br><span class="line">  /**</span><br><span class="line">   * 页面的初始数据</span><br><span class="line">   */</span><br><span class="line">  data: &#123;</span><br><span class="line">    date_: &apos;&apos;,                      // 传给后台时间</span><br><span class="line">    date: &apos;&apos;                        // 时间</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  /**</span><br><span class="line">   * 生命周期函数--监听页面加载</span><br><span class="line">   */</span><br><span class="line">  onLoad: function (options) &#123;</span><br><span class="line">    this.setData(&#123;</span><br><span class="line">      date_: week.getDates(1)[0].year + &apos;-&apos; + week.getDates(1)[0].month + &apos;-&apos; + week.getDates(1)[0].day,</span><br><span class="line">      date: week.getDates(1)[0].year + &apos;-&apos; + week.getDates(1)[0].month + &apos;-&apos; + week.getDates(1)[0].day + &apos; (&apos; + week.getDates(1)[0].week + &apos;)&apos;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  /**</span><br><span class="line">   * 时间选择器</span><br><span class="line">   */</span><br><span class="line">  bindDateChange: function (e) &#123;</span><br><span class="line">    var dateArry = [];</span><br><span class="line">    for (var i = 0; i &lt; 1; i++) &#123;</span><br><span class="line">      var dateObj = week.dateLater(e.detail.value, i);</span><br><span class="line">      dateArry.push(dateObj)</span><br><span class="line">    &#125;</span><br><span class="line">    this.setData(&#123;</span><br><span class="line">      date_: e.detail.value,</span><br><span class="line">      date: dateArry[0].year + &apos;-&apos; + dateArry[0].month + &apos;-&apos; + dateArry[0].day + &apos; (&apos; + dateArry[0].week + &apos;)&apos;</span><br><span class="line">    &#125;);</span><br><span class="line">    return dateArry;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  /**</span><br><span class="line">   * 选择上一天</span><br><span class="line">   */</span><br><span class="line">  leftTime: function (e) &#123;</span><br><span class="line">    var that = this;</span><br><span class="line">    var ldate = that.data.date_;</span><br><span class="line">    var arr = [];</span><br><span class="line">    arr.push(ldate.split(&quot;-&quot;));</span><br><span class="line"></span><br><span class="line">    var sec = parseInt(arr[0][2]) - 1;</span><br><span class="line">    var month = parseInt(arr[0][1]);</span><br><span class="line">    var year = parseInt(arr[0][0]);</span><br><span class="line">    if (sec &lt; 10) &#123;</span><br><span class="line">      if (sec == 0) &#123;</span><br><span class="line">        month--;</span><br><span class="line">        sec = week.getLastDay(year, month);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        sec = &quot;0&quot; + sec</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (month &lt; 10) &#123;</span><br><span class="line">      if (month == 0) &#123;</span><br><span class="line">        year--;</span><br><span class="line">        month = 12;</span><br><span class="line">        sec = 31;</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        month = &apos;0&apos; + month;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    var newTime = year + &apos;-&apos; + month + &apos;-&apos; + sec;</span><br><span class="line"></span><br><span class="line">    var dateArry = [];</span><br><span class="line">    for (var i = 0; i &lt; 1; i++) &#123;</span><br><span class="line">      var dateObj = week.dateLater(newTime, i);</span><br><span class="line">      dateArry.push(dateObj)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    wx.request(&#123;</span><br><span class="line">      url: &apos;&apos;,</span><br><span class="line">      data: &#123;</span><br><span class="line">        userId: &apos;&apos;,</span><br><span class="line">        date: dateArry[0].year + &apos;-&apos; + dateArry[0].month + &apos;-&apos; + sec</span><br><span class="line">      &#125;,</span><br><span class="line">      header: &#123; &apos;content-type&apos;: &apos;application/x-www-form-urlencoded&apos; &#125;,</span><br><span class="line">      method: &apos;POST&apos;,</span><br><span class="line">      dataType: &apos;json&apos;,</span><br><span class="line">      success: function (res) &#123;</span><br><span class="line">        // 内容获取</span><br><span class="line"></span><br><span class="line">        that.setData(&#123;</span><br><span class="line">          date: dateArry[0].year + &apos;-&apos; + month + &apos;-&apos; + sec,</span><br><span class="line">          date: dateArry[0].year + &apos;-&apos; + month + &apos;-&apos; + sec + &apos; (&apos; + dateArry[0].week + &apos;)&apos;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">      fail: function (res) &#123; &#125;,</span><br><span class="line">      complete: function (res) &#123; &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  /**</span><br><span class="line">   * 选择下一天</span><br><span class="line">   */</span><br><span class="line">  rightTime: function (e) &#123;</span><br><span class="line">    var that = this;</span><br><span class="line">    var ldate = that.data.date_;</span><br><span class="line">    var arr = [];</span><br><span class="line">    arr.push(ldate.split(&quot;-&quot;));</span><br><span class="line"></span><br><span class="line">    var sec = parseInt(arr[0][2]) + 1;</span><br><span class="line">    var month = parseInt(arr[0][1]);</span><br><span class="line">    var year = parseInt(arr[0][0]);</span><br><span class="line">    if (sec &lt; 10) &#123;</span><br><span class="line">      sec = &quot;0&quot; + sec</span><br><span class="line">    &#125; else if (sec == parseInt(week.getLastDay(year, month)) + 1) &#123;</span><br><span class="line">      month++;</span><br><span class="line">      sec = &apos;01&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">    if (month &lt; 10) &#123;</span><br><span class="line">      month = &apos;0&apos; + month;</span><br><span class="line">    &#125; else if (month == 12) &#123;</span><br><span class="line">      year++;</span><br><span class="line">      month = &apos;01&apos;;</span><br><span class="line">      sec = &apos;01&apos;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    var newTime = year + &apos;-&apos; + month + &apos;-&apos; + sec;</span><br><span class="line"></span><br><span class="line">    var dateArry = [];</span><br><span class="line">    for (var i = 0; i &lt; 1; i++) &#123;</span><br><span class="line">      var dateObj = week.dateLater(newTime, i);</span><br><span class="line">      dateArry.push(dateObj)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    wx.request(&#123;</span><br><span class="line">      url: &apos;&apos;,</span><br><span class="line">      data: &#123;</span><br><span class="line">        userId: &apos;&apos;,</span><br><span class="line">        date: dateArry[0].year + &apos;-&apos; + dateArry[0].month + &apos;-&apos; + sec</span><br><span class="line">      &#125;,</span><br><span class="line">      header: &#123; &apos;content-type&apos;: &apos;application/x-www-form-urlencoded&apos; &#125;,</span><br><span class="line">      method: &apos;POST&apos;,</span><br><span class="line">      dataType: &apos;json&apos;,</span><br><span class="line">      success: function (res) &#123;</span><br><span class="line">        // 内容获取</span><br><span class="line"></span><br><span class="line">        that.setData(&#123;</span><br><span class="line">          date_: dateArry[0].year + &apos;-&apos; + dateArry[0].month + &apos;-&apos; + sec,</span><br><span class="line">          date: dateArry[0].year + &apos;-&apos; + month + &apos;-&apos; + sec + &apos; (&apos; + dateArry[0].week + &apos;)&apos;</span><br><span class="line">        &#125;);</span><br><span class="line">        wx.navigateBack(&#123;</span><br><span class="line">          delta: 1,</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">      fail: function (res) &#123; &#125;,</span><br><span class="line">      complete: function (res) &#123; &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p><p>补充下wxml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;section clearfix&quot;&gt;</span><br><span class="line">  &lt;view  class=&apos;left fl&apos; bindtap=&apos;leftTime&apos;&gt;&lt;image src=&apos;../../images/left.png&apos;&gt;&lt;/image&gt;&lt;/view&gt;</span><br><span class="line">  &lt;picker mode=&quot;date&quot; value=&quot;&#123;&#123;date&#125;&#125;&quot; start=&quot;1790-01-01&quot; end=&quot;&#123;&#123;2022-01-01&#125;&#125;&quot; bindchange=&quot;bindDateChange&quot; class=&apos;fl&apos;&gt;</span><br><span class="line">    &lt;view class=&quot;picker&quot;&gt;</span><br><span class="line">      &#123;&#123;date&#125;&#125;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/picker&gt;</span><br><span class="line">  &lt;view  class=&apos;right fr&apos; bindtap=&apos;rightTime&apos;&gt;&lt;image src=&apos;../../images/right.png&apos;&gt;&lt;/image&gt;&lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/m0_37852904/article/details/80701664&quot; target=&quot;_blank&quot;&gt;日期、星期选择功能&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;js内（如utils.js）&lt;br&gt;&lt;figure class
      
    
    </summary>
    
    
      <category term="小程序" scheme="http://brightereyer.xyz/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>[小程序] 七牛云上传图片</title>
    <link href="http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103609000.html/"/>
    <id>http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103609000.html/</id>
    <published>2019-04-24T11:00:09.000Z</published>
    <updated>2019-04-24T11:00:09.000Z</updated>
    
    <content type="html"><![CDATA[<p>服务器端<br>QiniuToken<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import com.qiniu.util.Auth;</span><br><span class="line"></span><br><span class="line">@Controller</span><br><span class="line">@RequestMapping(value = &quot;/qiniu&quot;)</span><br><span class="line">public class QiniuToken &#123;</span><br><span class="line">// 获取token</span><br><span class="line">@RequestMapping(value = &quot;/getToken&quot;)</span><br><span class="line">public @ResponseBody Map&lt;String, String&gt; getToken() throws IOException &#123;</span><br><span class="line">String accessKey = &quot;xxx&quot;;</span><br><span class="line">        String secretKey = &quot;xxx&quot;;</span><br><span class="line">        String bucket = &quot;xxx&quot;;</span><br><span class="line">Auth auth = Auth.create(accessKey, secretKey);</span><br><span class="line">String upToken = auth.uploadToken(bucket);</span><br><span class="line">Map&lt;String, String&gt; map = new HashMap&lt;String, String&gt;();</span><br><span class="line">map.put(&quot;uptoken&quot;, upToken);</span><br><span class="line">return map;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><a href="https://github.com/gpake/qiniu-wxapp-sdk/blob/master/README.md?ref=developer.qiniu.com" target="_blank">github|七牛云小程序sdk</a></p><p><a href="https://my.oschina.net/hp2017/blog/2245455" target="_blank">微信小程序 - 前台接入七牛云上传图片和视频</a></p><p><a href="https://blog.csdn.net/qq_37905259/article/details/80559346" target="_blank">七牛云之微信小程序上传图片</a><br><a href="https://www.jianshu.com/p/3a89d0935dae" target="_blank">上传图片到七牛云</a><br>小程序上传图片只有两个关键API：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wx.chooseImage</span><br><span class="line">wx.uploadFile</span><br></pre></td></tr></table></figure></p><p>在wx.chooseImage调用成功时，可以获取到关于图片的文件信息，再上传七牛云<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">* 图片改变事件</span><br><span class="line">*/</span><br><span class="line">bindImgChange() &#123;</span><br><span class="line">    wx.chooseImage(&#123;</span><br><span class="line">        count: 1, // 最多可以选择的图片张数</span><br><span class="line">            success: res =&gt; &#123;</span><br><span class="line">                //上传七牛云</span><br><span class="line">                let tempFilePaths = res.tempFilePaths;</span><br><span class="line">                this.uploadQiniu(tempFilePaths);</span><br><span class="line">            &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p><p>上传七牛云代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">* 图片上传七牛云</span><br><span class="line">*/</span><br><span class="line">uploadQiniu(tempFilePaths) &#123;</span><br><span class="line">    let token = this.data.token;</span><br><span class="line">    var that = this;</span><br><span class="line">    wx.uploadFile(&#123;</span><br><span class="line">      url: &apos;https://upload-z2.qiniup.com&apos;,</span><br><span class="line">      name: &apos;file&apos;,</span><br><span class="line">      filePath: tempFilePaths[0],</span><br><span class="line">      header: &#123;</span><br><span class="line">        &quot;Content-Type&quot;: &quot;multipart/form-data&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">     formData: &#123;</span><br><span class="line">       token: token,</span><br><span class="line">     &#125;,</span><br><span class="line">     success: function(res) &#123;</span><br><span class="line">       let data = JSON.parse(res.data)</span><br><span class="line"></span><br><span class="line">       console.log(&apos;qiniu&apos;);</span><br><span class="line">       console.log(res);</span><br><span class="line">       // to do ...</span><br><span class="line">     &#125;,</span><br><span class="line">     fail: function(res) &#123;</span><br><span class="line">       console.log(res)</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;服务器端&lt;br&gt;QiniuToken&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line
      
    
    </summary>
    
    
      <category term="小程序" scheme="http://brightereyer.xyz/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>[小程序] 解决小程序iphoneX手机底部的兼容问题</title>
    <link href="http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103608000.html/"/>
    <id>http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103608000.html/</id>
    <published>2019-04-24T11:00:08.000Z</published>
    <updated>2019-04-24T11:00:08.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://juejin.im/post/5a1d396551882546d71f157b" target="_blank">小程序中吸底按钮适配 iPhone X 方案</a><br><a href="https://www.ifanr.com/minapp/958218" target="_blank">小程序中吸底按钮适配 iPhone X 方案</a></p><p>app.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">globalData: &#123;</span><br><span class="line">   isIphoneX: false,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p><p>index.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Page(&#123;</span><br><span class="line">  data:&#123;</span><br><span class="line">  isIphoneX:false</span><br><span class="line">  &#125;,</span><br><span class="line">  onShow: function() &#123;</span><br><span class="line">    var that = this;</span><br><span class="line">    wx.getSystemInfo(&#123;</span><br><span class="line">      success: res =&gt; &#123;</span><br><span class="line">        console.log(&apos;手机信息&apos;+res.model)</span><br><span class="line">        let modelmes = res.model;</span><br><span class="line">        if (modelmes.search(&apos;iPhone X&apos;) != -1) &#123;</span><br><span class="line">          app.globalData.isIphoneX = true;</span><br><span class="line">          that.setData(&#123;</span><br><span class="line">            isIphoneX: true</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">          app.globalData.isIphoneX = false;</span><br><span class="line">          that.setData(&#123;</span><br><span class="line">            isIphoneX: false</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>wxml：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;view wx:if=&quot;&#123;&#123;isIphoneX&#125;&#125;&quot; class=&quot;&#123;&#123;isIphoneX?&apos;fix-iphonex-button&apos;:&apos;&apos;&#125;&#125;&quot;&gt;</span><br><span class="line">  这是一个吸底按钮区域</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure></p><p>app.wxss<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">.fix-iphonex-button &#123;</span><br><span class="line">  bottom:68rpx!important;</span><br><span class="line">&#125;</span><br><span class="line">.fix-iphonex-button::after &#123;</span><br><span class="line">  content: &apos; &apos;;</span><br><span class="line">  position: fixed;</span><br><span class="line">  bottom: 0!important;</span><br><span class="line">  height: 68rpx!important;</span><br><span class="line">  width: 100%;</span><br><span class="line">  background: #fff;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://juejin.im/post/5a1d396551882546d71f157b&quot; target=&quot;_blank&quot;&gt;小程序中吸底按钮适配 iPhone X 方案&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://www.ifanr.com/mi
      
    
    </summary>
    
    
      <category term="小程序" scheme="http://brightereyer.xyz/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>[小程序] 使用指定或当前经纬度打开地图</title>
    <link href="http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103607000.html/"/>
    <id>http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103607000.html/</id>
    <published>2019-04-24T11:00:07.000Z</published>
    <updated>2019-04-24T11:00:07.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.cnblogs.com/dmcl/p/7700808.html" target="_blank">微信小程序城市定位(借助百度地图API判断城市)</a></p><p>根据指定经纬度打开地图位置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">bindLocation: function (e) &#123;</span><br><span class="line">  wx.openLocation(&#123;</span><br><span class="line">    latitude: e.target.dataset.latitude,</span><br><span class="line">    longitude: e.target.dataset.longitude,</span><br><span class="line">    name: e.target.dataset.name,</span><br><span class="line">    address: e.target.dataset.address</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p><p>根据当前经纬度打开位置、显示地址信息<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">chooseBaiduLocation: function(e) &#123;</span><br><span class="line">  var that = this;</span><br><span class="line">  wx.chooseLocation(&#123;</span><br><span class="line">    // ①.利用微信选择位置API，获得经纬度信息  </span><br><span class="line">    success: function(lb) &#123;</span><br><span class="line">      console.log(&quot;地理位置&quot;)</span><br><span class="line">      console.log(lb)</span><br><span class="line">      that.data.addressData = lb</span><br><span class="line">      wx.request(&#123;</span><br><span class="line">        // ②百度地图API，将微信获得的经纬度传给百度，获得城市等信息</span><br><span class="line">        url: &apos;https://api.map.baidu.com/geocoder/v2/?ak=GuMNe9FqXsvKoWY9VZaWNw9wlzUGjyTE&amp;location=&apos; + lb.latitude + &apos;,&apos; + lb.longitude + &apos;&amp;output=json&amp;coordtype=wgs84ll&apos;,</span><br><span class="line">        data: &#123;&#125;,</span><br><span class="line">        header: &#123;</span><br><span class="line">          &apos;Content-Type&apos;: &apos;application/json&apos;</span><br><span class="line">        &#125;,</span><br><span class="line">        success: function(res) &#123;</span><br><span class="line">          console.log(res.data.result);</span><br><span class="line"></span><br><span class="line">          var addressAll = res.data.result.addressComponent.city + res.data.result.addressComponent.district;</span><br><span class="line">          console.log(addressAll);</span><br><span class="line">          console.log(addressAll + &quot;·&quot; + lb.name);</span><br><span class="line">          that.setData(&#123;</span><br><span class="line">            addressAll: addressAll + &quot;·&quot; + lb.name //③.我们将微信得到的位置名称“故宫博物馆”与百度地图API得到的“北京市东城区”合并显示在页面上。</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;,</span><br><span class="line">        fail: function() &#123;</span><br><span class="line">          // fail</span><br><span class="line">        &#125;,</span><br><span class="line">        complete: function() &#123;</span><br><span class="line">          // complete</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    cancel: function(lb) &#123;&#125;,</span><br><span class="line">    fail: function(lb) &#123;</span><br><span class="line">      console.log(&quot;fail&quot;)</span><br><span class="line">      console.log(lb)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p><p><a href="https://www.jianshu.com/p/4f76fb5aa288" target="_blank">QQMapWX|输入地址自动获取经纬度</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">wx.getLocation(&#123;</span><br><span class="line">  type: &apos;gcj02&apos;, //返回可以用于wx.openLocation的经纬度</span><br><span class="line">  success: function(res) &#123;</span><br><span class="line">    var latitude = res.latitude</span><br><span class="line">    var longitude = res.longitude</span><br><span class="line">    wx.openLocation(&#123;</span><br><span class="line">      latitude: latitude,</span><br><span class="line">      longitude: longitude,</span><br><span class="line">      scale: 28</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p><a href="https://blog.csdn.net/haibo0668/article/details/80693265" target="_blank">qqmap显示指定地址的地图</a><br><a href="https://blog.csdn.net/weixin_43720095/article/details/84960891" target="_blank">获取某个位置经纬度以及地图显示</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/dmcl/p/7700808.html&quot; target=&quot;_blank&quot;&gt;微信小程序城市定位(借助百度地图API判断城市)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;根据指定经纬度打开地图位置&lt;br&gt;&lt;figure class=
      
    
    </summary>
    
    
      <category term="小程序" scheme="http://brightereyer.xyz/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>[小程序] string转number</title>
    <link href="http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103606000.html/"/>
    <id>http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103606000.html/</id>
    <published>2019-04-24T11:00:06.000Z</published>
    <updated>2019-04-24T11:00:06.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="" target="_blank"></a><br><a href="https://www.huoyuandl.com/xiaochengxu/24098.html" target="_blank">string转number</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">parseFloat(&quot;22.34.5&quot;); //returns 22.34</span><br><span class="line">Number( &quot;5.5 &quot;) 5.5</span><br></pre></td></tr></table></figure></p><p>微信小程序字符串转换为数字方法主要有三种：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">转换函数、强制类型转换、利用js变量弱类型转换。</span><br></pre></td></tr></table></figure></p><p>方法一：转换函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">js提供了parseInt()和parseFloat()两个转换函数。前者把值转换成整数，后者把值转换成浮点数。只有对String类型调用这些方法，这两个函数才能正确运行;对其他类型返回的都是NaN(Nota Number)。</span><br></pre></td></tr></table></figure></p><p>示例:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">parseInt(&quot;1234blue&quot;); //returns 1234</span><br><span class="line">parseInt(&quot;0xA&quot;); //returns 10</span><br><span class="line">parseInt(&quot;22.5&quot;); //returns 22</span><br><span class="line">parseInt(&quot;blue&quot;); //returns NaN</span><br></pre></td></tr></table></figure></p><p>parseInt()基模式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">把二进制、八进制、十六进制或其他任何进制的字符串转换成整数。基是由parseInt()方法的第二个参数指定的，示例如下：</span><br></pre></td></tr></table></figure></p><p>示例:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">parseInt(&quot;AF&quot;, 16); //returns 175</span><br><span class="line">parseInt(&quot;10&quot;, 2); //returns 2</span><br><span class="line">parseInt(&quot;10&quot;, 8); //returns 8</span><br><span class="line">parseInt(&quot;10&quot;, 10); //returns 10</span><br></pre></td></tr></table></figure></p><p>如果十进制数包含前导0，那么最好采用基数10，这样才不会意外地得到八进制的值。例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">parseInt(&quot;010&quot;); //returns 8</span><br><span class="line">parseInt(&quot;010&quot;, 8); //returns 8</span><br><span class="line">parseInt(&quot;010&quot;, 10); //returns 10</span><br></pre></td></tr></table></figure></p><p>parseFloat()方法与parseInt()方法的处理方式相似<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用parseFloat()方法的另一不同之处在于，字符串必须以十进制形式表示浮点数，parseFloat()没有基模式。</span><br></pre></td></tr></table></figure></p><p>下面是使用parseFloat()方法的示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">parseFloat(&quot;1234blue&quot;); //returns 1234.0</span><br><span class="line">parseFloat(&quot;0xA&quot;); //returns NaN</span><br><span class="line">parseFloat(&quot;22.5&quot;); //returns 22.5</span><br><span class="line">parseFloat(&quot;22.34.5&quot;); //returns 22.34</span><br><span class="line">parseFloat(&quot;0908&quot;); //returns 908</span><br><span class="line">parseFloat(&quot;blue&quot;); //returns NaN</span><br></pre></td></tr></table></figure></p><p>方法二：强制类型转换<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">还可使用强制类型转换(type casting)处理转换值的类型。使用强制类型转换可以访问特定的值，即使它是另一种类型的。</span><br><span class="line"></span><br><span class="line">ECMAScript中可用的3种强制类型转换如下：</span><br><span class="line"></span><br><span class="line">Boolean(value)——把给定的值转换成Boolean型;</span><br><span class="line"></span><br><span class="line">Number(value)——把给定的值转换成数字(可以是整数或浮点数);</span><br><span class="line"></span><br><span class="line">String(value)——把给定的值转换成字符串。</span><br><span class="line"></span><br><span class="line">用这三个函数之一转换值，将创建一个新值，存放由原始值直接转换成的值。这会造成意想不到的后果。</span><br><span class="line"></span><br><span class="line">当要转换的值是至少有一个字符的字符串、非0数字或对象(下一节将讨论这一点)时，Boolean()函数将返回true。如果该值是空字符串、数字0、undefined或null，它将返回false。</span><br></pre></td></tr></table></figure></p><p>可以用下面的小程序代码段测试Boolean型的强制类型转换<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Boolean(&quot;&quot;); //false – empty string</span><br><span class="line">Boolean(&quot;hi&quot;); //true – non-empty string</span><br><span class="line">Boolean(100); //true – non-zero number</span><br><span class="line">Boolean(null); //false - null</span><br><span class="line">Boolean(0); //false - zero</span><br><span class="line">Boolean(new Object()); //true – object</span><br></pre></td></tr></table></figure></p><p>Number()的强制类型转换与parseInt()和parseFloat()方法的处理方式相似，只是它转换的是整个值，而不是部分值。<br>示例如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Number(false) 0</span><br><span class="line">Number(true) 1</span><br><span class="line">Number(undefined) NaN</span><br><span class="line">Number(null) 0</span><br><span class="line">Number(&quot;5.5 &quot;) 5.5</span><br><span class="line">Number(&quot;56 &quot;) 56</span><br><span class="line">Number(&quot;5.6.7 &quot;) NaN</span><br><span class="line">Number(new Object()) NaN</span><br><span class="line">Number(100) 100</span><br></pre></td></tr></table></figure></p><p>强制类型转换方法String()：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var s1 = String(null); //&quot;null&quot;</span><br><span class="line">var oNull = null;</span><br><span class="line">var s2 = oNull.toString(); //won&apos;t work, causes an error</span><br></pre></td></tr></table></figure></p><p>方法三：利用js变量弱类型转换<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">var str = &apos;012.345&apos;;</span><br><span class="line">var x = str - 0;</span><br><span class="line">x = x * 1;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;&quot; target=&quot;_blank&quot;&gt;&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://www.huoyuandl.com/xiaochengxu/24098.html&quot; target=&quot;_blank&quot;&gt;string转number&lt;/a&gt;&lt;br&gt;&lt;figur
      
    
    </summary>
    
    
      <category term="小程序" scheme="http://brightereyer.xyz/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>[百度地图] 根据城市获取经纬度api</title>
    <link href="http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103605000.html/"/>
    <id>http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103605000.html/</id>
    <published>2019-04-24T11:00:05.000Z</published>
    <updated>2019-04-24T11:00:05.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="" target="_blank"></a><br><a href="https://blog.csdn.net/u013791374/article/details/51441768" target="_blank">利用百度地图api通过城市地址等信息取经纬度</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://api.map.baidu.com/geocoder?address=北京&amp;output=json&amp;key=826e806b86676d155282de3d37188137&amp;city=北京</span><br><span class="line"></span><br><span class="line">https://api.map.baidu.com/geocoder/v2/?ak=826e806b86676d155282de3d37188137&amp;output=json&amp;coordtype=wgs84ll&amp;address=%E5%8C%97%E4%BA%AC</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;&quot; target=&quot;_blank&quot;&gt;&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://blog.csdn.net/u013791374/article/details/51441768&quot; target=&quot;_blank&quot;&gt;利用百度地图api通过城市地址等信息
      
    
    </summary>
    
    
      <category term="百度地图" scheme="http://brightereyer.xyz/tags/%E7%99%BE%E5%BA%A6%E5%9C%B0%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>[springboot] 解决JS处理Long类型丢失精度</title>
    <link href="http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103604000.html/"/>
    <id>http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103604000.html/</id>
    <published>2019-04-24T11:00:04.000Z</published>
    <updated>2019-04-24T11:00:04.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://blog.csdn.net/lyj2018gyq/article/details/83593066" target="_blank">解决JS处理Long类型丢失精度</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Jackson、FastJson</span><br></pre></td></tr></table></figure></p><p>二、后端解决<br>2.1 Jackson<br>Spring MVC中默认是使用了Jackson的。通过重写转换器解决。</p><p>注意添加两个注解。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">import com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line">import com.fasterxml.jackson.databind.module.SimpleModule;</span><br><span class="line">import com.fasterxml.jackson.databind.ser.std.ToStringSerializer;</span><br><span class="line">import com.leyou.order.interceptor.LoginInterceptor;</span><br><span class="line">import com.leyou.order.properties.JwtProperties;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.boot.context.properties.EnableConfigurationProperties;</span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.context.annotation.Configuration;</span><br><span class="line">import org.springframework.http.converter.HttpMessageConverter;</span><br><span class="line">import org.springframework.http.converter.StringHttpMessageConverter;</span><br><span class="line">import org.springframework.http.converter.json.MappingJackson2HttpMessageConverter;</span><br><span class="line">import org.springframework.web.servlet.config.annotation.EnableWebMvc;</span><br><span class="line">import org.springframework.web.servlet.config.annotation.InterceptorRegistry;</span><br><span class="line">import org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;</span><br><span class="line">import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"> </span><br><span class="line">import java.math.BigInteger;</span><br><span class="line">import java.nio.charset.Charset;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">@Configuration</span><br><span class="line">@EnableWebMvc</span><br><span class="line">public class MvcConfig implements WebMvcConfigurer &#123;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void configureMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters) &#123;</span><br><span class="line"> </span><br><span class="line">        MappingJackson2HttpMessageConverter jackson2HttpMessageConverter =</span><br><span class="line">                new MappingJackson2HttpMessageConverter();</span><br><span class="line"> </span><br><span class="line">        ObjectMapper objectMapper = new ObjectMapper();</span><br><span class="line">        SimpleModule simpleModule = new SimpleModule();</span><br><span class="line">        simpleModule.addSerializer(BigInteger.class, ToStringSerializer.instance);</span><br><span class="line">        simpleModule.addSerializer(Long.class, ToStringSerializer.instance);</span><br><span class="line">        simpleModule.addSerializer(Long.TYPE, ToStringSerializer.instance);</span><br><span class="line">        objectMapper.registerModule(simpleModule);</span><br><span class="line">        jackson2HttpMessageConverter.setObjectMapper(objectMapper);</span><br><span class="line">        converters.add(jackson2HttpMessageConverter);</span><br><span class="line">        converters.add(new StringHttpMessageConverter(Charset.forName(&quot;UTF-8&quot;)));</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>2.2 Fastjson<br>在Spring Boot中将Jackson替换为fastjson一般会有两种方式：<br>第一种：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">public class WebConfig extends WebMvcConfigurerAdapter &#123;</span><br><span class="line"> </span><br><span class="line">    @Bean</span><br><span class="line">    public HttpMessageConverters fastJsonHttpMessageConverter() &#123;</span><br><span class="line">        return new HttpMessageConverters(new FastJsonHttpMessageConverter());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>第二种：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">public class WebConfig extends WebMvcConfigurerAdapter &#123;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void configureMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters) &#123;</span><br><span class="line">        FastJsonHttpMessageConverter fastConverter = </span><br><span class="line">        new FastJsonHttpMessageConverter();</span><br><span class="line"> </span><br><span class="line">        FastJsonConfig fastJsonConfig = new FastJsonConfig();</span><br><span class="line">        fastJsonConfig.setSerializerFeatures(SerializerFeature.PrettyFormat);</span><br><span class="line">        fastConverter.setFastJsonConfig(fastJsonConfig);</span><br><span class="line">        converters.add(fastConverter);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>替换成fastjson之后，对于精度丢失问题，解决方法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@EnableWebMvc</span><br><span class="line">@Configuration</span><br><span class="line">public class WebConfig extends WebMvcConfigurerAdapter &#123;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void configureMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters) &#123;</span><br><span class="line">        FastJsonHttpMessageConverter fastConverter = </span><br><span class="line">        new FastJsonHttpMessageConverter();</span><br><span class="line"> </span><br><span class="line">        FastJsonConfig fastJsonConfig = new FastJsonConfig();</span><br><span class="line">        SerializeConfig serializeConfig = SerializeConfig.globalInstance;</span><br><span class="line">        serializeConfig.put(BigInteger.class, ToStringSerializer.instance);</span><br><span class="line">        serializeConfig.put(Long.class, ToStringSerializer.instance);</span><br><span class="line">        serializeConfig.put(Long.TYPE, ToStringSerializer.instance);</span><br><span class="line">        fastJsonConfig.setSerializeConfig(serializeConfig);</span><br><span class="line">        fastConverter.setFastJsonConfig(fastJsonConfig);</span><br><span class="line">        converters.add(fastConverter);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/lyj2018gyq/article/details/83593066&quot; target=&quot;_blank&quot;&gt;解决JS处理Long类型丢失精度&lt;/a&gt;&lt;br&gt;&lt;figure class=&quot;highlight plai
      
    
    </summary>
    
    
      <category term="springboot" scheme="http://brightereyer.xyz/tags/springboot/"/>
    
  </entry>
  
  <entry>
    <title>[mysql] 带经纬度全国省市区县表</title>
    <link href="http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103603000.html/"/>
    <id>http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103603000.html/</id>
    <published>2019-04-24T11:00:03.000Z</published>
    <updated>2019-04-24T11:00:03.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://blog.csdn.net/chengmeng_123/article/details/74984116" target="_blank">带经纬度全国省市区县表</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/chengmeng_123/article/details/74984116&quot; target=&quot;_blank&quot;&gt;带经纬度全国省市区县表&lt;/a&gt;&lt;/p&gt;

      
    
    </summary>
    
    
      <category term="mysql" scheme="http://brightereyer.xyz/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>[js] 计算两个经纬度之间的距离</title>
    <link href="http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103602000.html/"/>
    <id>http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103602000.html/</id>
    <published>2019-04-24T11:00:02.000Z</published>
    <updated>2019-04-24T11:00:02.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="" target="_blank"></a><br><a href="https://segmentfault.com/a/1190000010371592" target="_blank">计算两个经纬度之间的距离</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// 方法定义 lat,lng </span><br><span class="line">function GetDistance( lat1,  lng1,  lat2,  lng2)&#123;</span><br><span class="line">    var radLat1 = lat1*Math.PI / 180.0;</span><br><span class="line">    var radLat2 = lat2*Math.PI / 180.0;</span><br><span class="line">    var a = radLat1 - radLat2;</span><br><span class="line">    var  b = lng1*Math.PI / 180.0 - lng2*Math.PI / 180.0;</span><br><span class="line">    var s = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin(a/2),2) +</span><br><span class="line">    Math.cos(radLat1)*Math.cos(radLat2)*Math.pow(Math.sin(b/2),2)));</span><br><span class="line">    s = s *6378.137 ;// EARTH_RADIUS;</span><br><span class="line">    s = Math.round(s * 10000) / 10000;</span><br><span class="line">    return s;</span><br><span class="line">&#125;</span><br><span class="line">// 调用 return的距离单位为km</span><br><span class="line">GetDistance(116.29812,39.95931,116.41,39.91)</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;&quot; target=&quot;_blank&quot;&gt;&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://segmentfault.com/a/1190000010371592&quot; target=&quot;_blank&quot;&gt;计算两个经纬度之间的距离&lt;/a&gt;&lt;br&gt;&lt;figure clas
      
    
    </summary>
    
    
      <category term="js" scheme="http://brightereyer.xyz/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>[css] 使用::before和::after伪元素在网站中添加图标</title>
    <link href="http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103601000.html/"/>
    <id>http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103601000.html/</id>
    <published>2019-04-24T11:00:01.000Z</published>
    <updated>2019-04-24T11:00:01.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.cnblogs.com/yaotome/p/9322814.html" target="_blank">使用::before和::after伪元素在网站中添加图标</a></p><p>css after 插入图片，怎么设置内容高度<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.nav ul li:after&#123;</span><br><span class="line">    content:&apos;&apos;;</span><br><span class="line">    background:url(../img/nav_fg.png) no-repeat;</span><br><span class="line">    background-size:40px;</span><br><span class="line">    width:40px;</span><br><span class="line">    height:40px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.nav ul li:after&#123;</span><br><span class="line">    content:&apos;\20&apos;;</span><br><span class="line">    background:url(../img/nav_fg.png) no-repeat;</span><br><span class="line">    background-size:40px;</span><br><span class="line">    width:40px;</span><br><span class="line">    height:40px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/yaotome/p/9322814.html&quot; target=&quot;_blank&quot;&gt;使用::before和::after伪元素在网站中添加图标&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;css after 插入图片，怎么设置内容高度
      
    
    </summary>
    
    
      <category term="css" scheme="http://brightereyer.xyz/tags/css/"/>
    
  </entry>
  
  <entry>
    <title>[css] 文本溢出处理</title>
    <link href="http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103600000.html/"/>
    <id>http://brightereyer.xyz/2019/04/24//articles/2019/04/24/1556103600000.html/</id>
    <published>2019-04-24T11:00:00.000Z</published>
    <updated>2019-04-24T11:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.cnblogs.com/qingcaixiaoge/p/5549158.html" target="_blank">html文字溢出以省略号(…)替代</a></p><p>一、单行文本溢出以省略号(…)替代<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">    div&#123;</span><br><span class="line">        text-overflow: ellipsis;</span><br><span class="line">        overflow: hidden;</span><br><span class="line">        white-space: nowrap; //强制不换行</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p><p>宽度超出200px;换行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">    div&#123;</span><br><span class="line">    width: 200px;</span><br><span class="line">        text-overflow: ellipsis;</span><br><span class="line">        overflow: hidden;</span><br><span class="line">        white-space: nowrap; //强制不换行</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p><p>二、多行文本溢出<br>伪元素(::after)实现方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">    div&#123;</span><br><span class="line">        position: relative;</span><br><span class="line">        overflow: hidden;</span><br><span class="line">        width: 200px;</span><br><span class="line">        height: 55px;</span><br><span class="line">        line-height: 30px;</span><br><span class="line">        font-size: 20px;               </span><br><span class="line">    &#125;</span><br><span class="line">    div::after&#123;</span><br><span class="line">        position: absolute;</span><br><span class="line">        bottom: 0;</span><br><span class="line">        right: 0;</span><br><span class="line">        padding:0 5px 1px 45px;</span><br><span class="line">        content: &apos;...&apos;;            </span><br><span class="line">        background:url(ellipsis_bg.png) repeat-y;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/qingcaixiaoge/p/5549158.html&quot; target=&quot;_blank&quot;&gt;html文字溢出以省略号(…)替代&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;一、单行文本溢出以省略号(…)替代&lt;br&gt;&lt;figure 
      
    
    </summary>
    
    
      <category term="css" scheme="http://brightereyer.xyz/tags/css/"/>
    
  </entry>
  
  <entry>
    <title>[服务器] 邮件服务器james</title>
    <link href="http://brightereyer.xyz/2019/04/21//articles/2019/04/21/1555845075000.html/"/>
    <id>http://brightereyer.xyz/2019/04/21//articles/2019/04/21/1555845075000.html/</id>
    <published>2019-04-21T11:11:15.000Z</published>
    <updated>2019-04-21T11:11:15.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://james.apache.org/download.cgi#Apache_James_Server" target="_blank">james</a><br><a href="https://www.apache.org/dyn/closer.lua/james/server/james-server-app-3.2.0-app.zip" target="_blank">james-server-app-3.2.0-app.zip</a><br><a href="https://www.apache.org/dyn/closer.lua/james/server/3.2.0/james-server-sources-3.2.0.zip" target="_blank">james-server-sources-3.2.0.zip</a></p><p><a href="https://www.cnblogs.com/xk920/p/9842666.html" target="_blank">James 3.1服务器的安装与搭建</a><br><a href="https://blog.csdn.net/Fanpei_moukoy/article/details/80025318" target="_blank">james使用（一）：windows环境下james3.0.1版本邮件服务器搭建及配置</a></p><p><a href="https://www.cnblogs.com/s1294/p/6030759.html" target="_blank">搭建james邮件服务器</a></p><p>工具准备<br><a href="https://pan.baidu.com/s/1_T3BxgKyRoXZJodY2vBbDA" target="_blank">James 3.1服务器的安装与搭建</a><br>(1)<a href="https://pan.baidu.com/s/1_T3BxgKyRoXZJodY2vBbDA" target="_blank">james安装包</a>密码：hntp<br>(2)<a href="https://pan.baidu.com/s/1LrGQCxHWO8TND7DMwM_CiQ" target="_blank">jdk1.8</a>密码：yfv4<br>(3)<a href="https://pan.baidu.com/s/1QZFo46zJrtNDvJtsRuQN2Q" target="_blank">foxmail客户端</a>密码：bl1g</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">3.1 hosts配置本地域名</span><br><span class="line">ipconfig</span><br><span class="line">C:\Windows\System32\drivers\etc\hosts</span><br><span class="line">192.168.10.130 jameserver.com</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">3.2 解压</span><br><span class="line">解压安装包到 C:\Program Files\james\james-server-app-3.0.1目录下</span><br><span class="line"></span><br><span class="line">james-server-app-3.0.1</span><br><span class="line">    ---bin:程序各种工具和运行程序目录</span><br><span class="line">    ---lib:依赖包</span><br><span class="line">    ---conf:在该目录下修改配置文件</span><br><span class="line">    ---var:jamse server存储数据目录</span><br><span class="line"></span><br><span class="line">3.3 修改配置文件</span><br><span class="line">将所有文件的后缀名.template去掉，然后复制到conf目录下</span><br></pre></td></tr></table></figure><p>修改配置文件</p><table><thead><tr><th>配置文件名称</th><th>原内容</th><th>修改后内容</th></tr></thead><tbody><tr><td>domainlist</td><td><defaultdomain>localhost</defaultdomain></td><td><defaultdomain>jameserver.com</defaultdomain> </td></tr><tr><td>imapserver</td><td><bind>0.0.0.0:143</bind></td><td><bind>jameserver.com:143</bind> </td></tr><tr><td>smtpserver</td><td><bind>0.0.0.0:25</bind></td><td><bind>jameserver.com:25</bind> </td></tr><tr><td>pop3server</td><td><bind>0.0.0.0:110</bind></td><td><bind>jameserver.com:110</bind> </td></tr><tr><td>jmx</td><td>jmx.address=127.0.0.1</td><td>jmx.address=jameserver.com </td></tr><tr><td>mailetcontainer</td><td><postmaster>postmaster@localhost</postmaster></td><td><postmaster><a href="mailto:postmaster@jameserver.com" target="_blank" rel="noopener">postmaster@jameserver.com</a></postmaster> </td></tr><tr><td>managesieveserver</td><td><bind>0.0.0.0:4190</bind></td><td><bind>jameserver.com:4190</bind> </td></tr></tbody></table><p>修改<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin\wrapper.conf</span><br></pre></td></tr></table></figure></p><p>执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin\run.bat</span><br></pre></td></tr></table></figure></p><p>james各种命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#以console模式启动james并将日志输出到console窗口上（作用类似于上文中的run,bat）</span><br><span class="line">console</span><br><span class="line">#启动</span><br><span class="line">start</span><br><span class="line">#暂停</span><br><span class="line">pause</span><br><span class="line">#重置</span><br><span class="line">resume</span><br><span class="line">#停止</span><br><span class="line">stop</span><br><span class="line">#重启</span><br><span class="line">restart</span><br><span class="line">#安装</span><br><span class="line">install</span><br><span class="line">#卸载</span><br><span class="line">remove</span><br><span class="line">#启动状态</span><br><span class="line">status</span><br></pre></td></tr></table></figure></p><p>james-cli<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#添加用户 格式为 adduser &lt;name&gt; &lt;passwd&gt;</span><br><span class="line">adduser</span><br><span class="line"></span><br><span class="line">#移除用户 格式为 removeuser xxx1@xxx2 [移除时必须跟上全称即必须@加域名]</span><br><span class="line">removeuser</span><br><span class="line"></span><br><span class="line">#列出所有用户</span><br><span class="line">listusers</span><br><span class="line"></span><br><span class="line">#添加域名 域名为@后的那部分，表示隶属于哪个公司，例如网上有163.com qq.com等，此处可自定义</span><br><span class="line">adddomain</span><br><span class="line"></span><br><span class="line">#移除域名</span><br><span class="line">remvedomain</span><br><span class="line"></span><br><span class="line">#列出所有域名</span><br><span class="line">listdomains</span><br><span class="line"></span><br><span class="line">#单独设置某用户的密码 格式为setpassword &lt;username&gt; &lt;passwd&gt; 其中username 为全称，例如xxx1@xxx2</span><br><span class="line">setpassword</span><br><span class="line"></span><br><span class="line">#检测是否包含某域名</span><br><span class="line">containsdomain</span><br></pre></td></tr></table></figure></p><p>使用james命令进行安装<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin\james</span><br></pre></td></tr></table></figure></p><p>启动james<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#安装服务到系统：</span><br><span class="line">james install</span><br><span class="line">#启动服务:</span><br><span class="line">james start</span><br><span class="line">#查看服务状态</span><br><span class="line">james status</span><br></pre></td></tr></table></figure></p><p>使用james-cli命令配置邮件后缀域名和用户<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin\james-cli</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">james start</span><br><span class="line">#添加域名 jameserver.com</span><br><span class="line">james-cli -h 192.168.10.130 adddomain jameserver.com</span><br><span class="line">#添加用户 test1@jameserver.com 并设置密码为 test</span><br><span class="line">james-cli -h 192.168.10.130 adduser test1@jameserver.com test</span><br><span class="line">#添加用户 test2@jameserver.com 并设置密码为 test</span><br><span class="line">james-cli -h 192.168.10.130 adduser test2@jameserver.com test</span><br><span class="line">#执行成功后利用listdomains 和 listusers查看</span><br><span class="line">listdomains</span><br><span class="line">listusers</span><br></pre></td></tr></table></figure><blockquote><p>4.使用foxmail客户端测试james server</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">4.1 登录第一个账号，如图输入用户和密码点击创建</span><br><span class="line">test1@jameserver.com</span><br><span class="line">test</span><br></pre></td></tr></table></figure><p>4.2 配置服务器<br>在途中红色框位置输入james安装所在的ip 192.168.10.130,端口号由于使用标准协议不用修改，此处我未进行修改直接点创建成功，原因在于我已经在hosts中配置dns映射，若未配置则需要输入ip<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">接受服务类型：IMAP</span><br><span class="line">邮件账号：test1@jameserver.com</span><br><span class="line">密码：test</span><br><span class="line">IMAP服务器：jameserver.com 端口：143</span><br><span class="line">SMTP服务器：jameserver.com 端口：25</span><br></pre></td></tr></table></figure></p><p>4.3 添加另一个账号<br>如下图所示，点击左下角【创建】，填写用户名和服务器信息，点击【创建】后确定，添加完成：</p><p>4.5 编写邮件并发送后，查看是否能收到邮件</p><p>若想连接数据库，需要修改配置文件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">（1）打开\conf\lib，导入所需要的与数据库连接的jar包。因为我用的是mysql数据库，所以jar包用的是：mysql-connector-java-bin.jar</span><br><span class="line">（2）将conf下所有以.conf结尾的配置文件全改为.xml，并将前面的-template删除</span><br><span class="line">（3）修改james-database-template.properties改为james-database.properties,并将其里面的内容改为</span><br><span class="line">database.driverClassName=com.mysql.jdbc.Driver</span><br><span class="line">database.url=jdbc:mysql://localhost:3306/email</span><br><span class="line">database.username=root</span><br><span class="line">database.password=root</span><br><span class="line"></span><br><span class="line">vendorAdapter.database=MYSQL</span><br><span class="line"></span><br><span class="line">openjpa.streaming=false</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://james.apache.org/download.cgi#Apache_James_Server&quot; target=&quot;_blank&quot;&gt;james&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://www.apache.org/dyn/clos
      
    
    </summary>
    
    
      <category term="服务器" scheme="http://brightereyer.xyz/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>[springboot] 邮件找回密码功能</title>
    <link href="http://brightereyer.xyz/2019/04/21//articles/2019/04/21/1555845074000.html/"/>
    <id>http://brightereyer.xyz/2019/04/21//articles/2019/04/21/1555845074000.html/</id>
    <published>2019-04-21T11:11:14.000Z</published>
    <updated>2019-04-21T11:11:14.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.jianshu.com/p/27f8312b5da0" target="_blank">简书|[Springboot]发送邮件、重置密码业务实战</a><br><a href="https://blog.csdn.net/qqxx6661/article/details/87352041" target="_blank">csdn|[Springboot]发送邮件、重置密码业务实战</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">业务流程</span><br><span class="line">根据controller中函数分为两个部分：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">用户申请重置邮件：</span><br><span class="line">用户在页面中输入邮箱</span><br><span class="line">服务器检查是否允许重置（邮箱所指向用户是否存在，重置是否过于频繁，重置是否到达日请求上限）</span><br><span class="line">验证通过后，想validate表写入申请记录，包含token，用户邮箱和id</span><br><span class="line">发送邮件（包含带有token的链接）</span><br><span class="line">用户点击邮件内连接</span><br><span class="line">跳转到新密码输入网页</span><br><span class="line">提交重置密码请求（POST中包含token，新密码）</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">用户重置密码</span><br><span class="line">服务器验证token（token是否过期，该用户是否发起过其它新token）</span><br><span class="line">通过validate表记录查找用户id，修改用户密码</span><br></pre></td></tr></table></figure></p><p><a href="https://github.com/qqxx6661/tmall_ssm/blob/master/src/main/resources/generatorConfig.xml" target="_blank">generatorConfig.xml</a></p><p><a href="https://blog.csdn.net/linzhiqiang0316/article/details/52863265" target="_blank">SpringBoot中实现邮件找回密码的功能</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">title: &apos;[springboot] 邮件找回密码功能&apos;</span><br><span class="line">date: &apos;2019-04-21 19:11:13&apos;</span><br><span class="line">updated: &apos;2019-04-21 19:11:13&apos;</span><br><span class="line">tags: [springboot]</span><br><span class="line">permalink: /articles/2019/04/21/1555845073000.html</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">package example.utils;</span><br><span class="line">public class RandomUtils &#123;</span><br><span class="line">    //获取m~n范围内的整数</span><br><span class="line">    public static int getRandom(int m,int n)&#123;</span><br><span class="line">        int random=(int)(Math.random()*(n-m))+m;</span><br><span class="line">        return random;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    //获取位数为n的随机数</span><br><span class="line">    public static int getRandom(int length)&#123;</span><br><span class="line">        int m=getNumber(length);</span><br><span class="line">        int n=m*10-1;</span><br><span class="line">        int random=(int)(Math.random()*(n-m))+m;</span><br><span class="line">        return random;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public static int getNumber(int n)&#123;</span><br><span class="line">        if(n&lt;1)&#123;</span><br><span class="line">            n=1;</span><br><span class="line">        &#125;</span><br><span class="line">        if(n==1)&#123;</span><br><span class="line">            return 1;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            n=n-1;</span><br><span class="line">            return 10*getNumber(n);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Md5检验的工具类：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> example.encrypt;</span><br><span class="line"><span class="keyword">import</span> sun.misc.BASE64Encoder;</span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Md5Encrypt</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**利用MD5进行加密</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> str  待加密的字符串</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>  加密后的字符串</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">EncoderByMd5</span><span class="params">(String str)</span></span>&#123;</span><br><span class="line">        <span class="comment">//确定计算方法</span></span><br><span class="line">        MessageDigest md5= <span class="keyword">null</span>;</span><br><span class="line">        String result=<span class="string">""</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            md5 = MessageDigest.getInstance(<span class="string">"MD5"</span>);</span><br><span class="line">            result=<span class="keyword">new</span> BASE64Encoder().encode(md5.digest(str.getBytes(<span class="string">"utf-8"</span>)));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//加密后的字符串</span></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>生成url核心代码：<br>业务层代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//找回密码</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Object <span class="title">findPassowrd</span><span class="params">(String basePath,String account)</span></span>&#123;</span><br><span class="line">      Manage manage= manageDao.findByAccount(account);</span><br><span class="line">      String code,info,result;</span><br><span class="line">      <span class="keyword">if</span>(manage==<span class="keyword">null</span>)&#123;</span><br><span class="line">          code=<span class="string">"001"</span>;</span><br><span class="line">          info=<span class="string">"Account does not exist"</span>;</span><br><span class="line">          result=<span class="string">""</span>;</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          <span class="comment">//生成邮件url唯一地址</span></span><br><span class="line">          String key= RandomUtils.getRandom(<span class="number">6</span>)+<span class="string">""</span>;</span><br><span class="line">          Timestamp outDate = <span class="keyword">new</span> Timestamp(System.currentTimeMillis()+(<span class="keyword">long</span>)(<span class="number">30</span>*<span class="number">60</span>*<span class="number">1000</span>));<span class="comment">//30分钟后过期             //忽略毫秒数</span></span><br><span class="line">          <span class="keyword">long</span> outtimes=outDate.getSysUpTime();</span><br><span class="line">          String sid=account+<span class="string">"&amp;"</span>+key+<span class="string">"&amp;"</span>+outtimes;</span><br><span class="line">          MailRetrieve mailRetrieve=<span class="keyword">new</span> MailRetrieve(account,Md5Encrypt.EncoderByMd5(sid),outtimes);</span><br><span class="line">          MailRetrieve findMailRetrieve=mailRetrieveDao.findByAccount(account);</span><br><span class="line">          <span class="keyword">if</span>(findMailRetrieve!=<span class="keyword">null</span>)&#123;</span><br><span class="line">              mailRetrieveDao.delete(findMailRetrieve);</span><br><span class="line">          &#125;</span><br><span class="line">          mailRetrieveDao.save(mailRetrieve);</span><br><span class="line">          result =  basePath+<span class="string">"user/reset_password?sid="</span>+Md5Encrypt.EncoderByMd5(sid)+<span class="string">"&amp;userName="</span>+account;</span><br><span class="line">          code=<span class="string">"005"</span>;</span><br><span class="line">          info=<span class="string">"Email retrieve password"</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> JsonUtils.toJson(code,info,result);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p><p>控制层的代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/back"</span>)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">backManage</span><span class="params">(HttpServletRequest request,String account)</span></span>&#123;</span><br><span class="line">    String path = request.getContextPath();</span><br><span class="line">    String basePath = request.getScheme()+<span class="string">"://"</span>+request.getServerName()+<span class="string">":"</span>+request.getServerPort()+path+<span class="string">"/"</span>;</span><br><span class="line">    <span class="keyword">return</span> manageService.findPassowrd(basePath,account);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>邮件实体类：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> example.entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.*;</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"myweb_mail_retrieve"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MailRetrieve</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">1L</span>;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.AUTO)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"account"</span>, nullable = <span class="keyword">true</span>, length = <span class="number">20</span>)</span><br><span class="line">    <span class="keyword">private</span> String account;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"sid"</span>, nullable = <span class="keyword">true</span>, length = <span class="number">25</span>)</span><br><span class="line">    <span class="keyword">private</span> String sid;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"out_time"</span>, nullable = <span class="keyword">true</span>, length = <span class="number">20</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> outTime;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MailRetrieve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MailRetrieve</span><span class="params">(String account, String sid, <span class="keyword">long</span> outTime)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.account = account;</span><br><span class="line">        <span class="keyword">this</span>.sid = sid;</span><br><span class="line">        <span class="keyword">this</span>.outTime = outTime;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">getSerialVersionUID</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> serialVersionUID;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MailRetrieve</span><span class="params">(String account)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.account = account;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sid;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSid</span><span class="params">(String sid)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sid = sid;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getOutTime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> outTime;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOutTime</span><span class="params">(<span class="keyword">long</span> outTime)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.outTime = outTime;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>3.通过James邮件服务器将url地址发送到用户邮箱中（具体过程看以前的案例介绍）。<br>4.点击url地址，服务器进行邮件url地址检验，检验完跳转到相应的界面中进行处理：</p><p>业务层代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//邮件U找回密码URL校验</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> Object <span class="title">verifyMail</span><span class="params">(String sid,String account)</span></span>&#123;</span><br><span class="line">       String code,info;</span><br><span class="line">       <span class="keyword">boolean</span> result=<span class="keyword">false</span>;</span><br><span class="line">       MailRetrieve mailRetrieve=mailRetrieveDao.findByAccount(account);</span><br><span class="line">       <span class="keyword">long</span> outTime=mailRetrieve.getOutTime();</span><br><span class="line">       Timestamp outDate = <span class="keyword">new</span> Timestamp(System.currentTimeMillis());</span><br><span class="line">       <span class="keyword">long</span> nowTime=outDate.getSysUpTime();</span><br><span class="line">       System.out.println(<span class="string">"nowTime:"</span>+nowTime);</span><br><span class="line">       <span class="keyword">if</span>(outTime&lt;=nowTime)&#123;</span><br><span class="line">           code=<span class="string">"006"</span>;</span><br><span class="line">           info=<span class="string">"verifyMail time is overdue"</span>;</span><br><span class="line">       &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">""</span>.equals(sid))&#123;</span><br><span class="line">           code=<span class="string">"007"</span>;</span><br><span class="line">           info=<span class="string">"sid is incomplete content"</span>;</span><br><span class="line">       &#125;<span class="keyword">else</span> <span class="keyword">if</span>(!sid.equals(mailRetrieve.getSid()))&#123;</span><br><span class="line">           code=<span class="string">"008"</span>;</span><br><span class="line">           info=<span class="string">"sid is error"</span>;</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">           code=<span class="string">"000"</span>;</span><br><span class="line">           info=<span class="string">"no error"</span>;</span><br><span class="line">           result=<span class="keyword">true</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> JsonUtils.toJson(code,info,result);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p><p>控制层代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/verify"</span>)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">verifyMail</span><span class="params">(String sid,String account)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> manageService.verifyMail(sid,account);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>这整个过程中需要注意的有：<br>1、时间是否过期要判断好<br>2、保存邮件url信息的时候要注意数据库中是否有这个信息存在，如果存在则删除重新添加。</p><p><code>`</code></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://www.jianshu.com/p/27f8312b5da0&quot; target=&quot;_blank&quot;&gt;简书|[Springboot]发送邮件、重置密码业务实战&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://blog.csdn.net/qqxx6
      
    
    </summary>
    
    
      <category term="springboot" scheme="http://brightereyer.xyz/tags/springboot/"/>
    
  </entry>
  
  <entry>
    <title>[springcloud] springcloud</title>
    <link href="http://brightereyer.xyz/2019/04/20//articles/2019/04/20/1555759263000.html/"/>
    <id>http://brightereyer.xyz/2019/04/20//articles/2019/04/20/1555759263000.html/</id>
    <published>2019-04-20T11:21:03.000Z</published>
    <updated>2019-04-20T11:21:03.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="http://www.funtl.com/zh/guide/" target="_blank">广州千锋</a><br><a href="https://www.jianshu.com/nb/32876435" target="_blank">简书|广州千锋</a><br><a href="https://github.com/funtl/spring-cloud-netflix-itoken" target="_blank">github|广州千锋</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;http://www.funtl.com/zh/guide/&quot; target=&quot;_blank&quot;&gt;广州千锋&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://www.jianshu.com/nb/32876435&quot; target=&quot;_blank&quot;&gt;简书|广州千
      
    
    </summary>
    
    
      <category term="springcloud" scheme="http://brightereyer.xyz/tags/springcloud/"/>
    
  </entry>
  
</feed>
